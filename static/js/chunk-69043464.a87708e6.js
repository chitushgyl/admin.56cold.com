(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69043464"],{"6d2a":function(t,e,a){},"94d2":function(t,e,a){"use strict";a("6d2a")},c9d9:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var i={ajax:"ajax",wicket:"wicket",edit:"edit"}},ce850:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"table-header header-fixed"},[a("div",{staticClass:"flex-space-between table-title-container"},[a("div",[t._v("校车列表")]),t._v(" "),a("div",t._l(t.thButtonInfo,(function(e){return a("el-button",{key:e.id,staticClass:"filter-item",style:[{backgroundColor:e.color,color:"white"}],attrs:{size:"mini",icon:e.img},on:{click:function(a){return t.onThBtnClick(e)}}},[t._v("\n              "+t._s("icon"==e.show_flag?null:e.name)+"\n          ")])})),1)]),t._v(" "),a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"姓名",clearable:""},model:{value:t.listQuery.actual_name,callback:function(e){t.$set(t.listQuery,"actual_name",e)},expression:"listQuery.actual_name"}}),t._v(" "),a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"身份证号",clearable:""},model:{value:t.listQuery.identity_card,callback:function(e){t.$set(t.listQuery,"identity_card",e)},expression:"listQuery.identity_card"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onFilter}},[t._v("\n          查找\n          ")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,staticStyle:{width:"100%"},attrs:{data:t.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:"名称","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s("中文名称:"+i.actual_name))]),t._v(" "),a("br"),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:i.english_name,expression:"row.english_name"}]},[t._v(t._s("英文名称:"+i.english_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"身份证号","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s("身份证号:"+i.identity_card))]),t._v(" "),a("br"),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:i.sex,expression:"row.sex"}]},[t._v(t._s("性别:"+i.sex))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return a("div",{staticClass:"flex-column"},[a("span",[t._v(t._s("Y"==i.use_flag?"在校":"离校"))])])}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"200","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row,n=e.$index;return t._l(i.button_info,(function(e){return a("div",{key:e.id,staticStyle:{display:"inline-block"}},["text"==e.show_flag&&null==e.img?a("el-button",{staticStyle:{padding:"3px","margin-right":"5px"},attrs:{size:"mini",plain:"",type:e.but_type},on:{click:function(a){return t.onRowBtnClick(i,n,e)}}},[t._v(t._s(e.name))]):t._e(),t._v(" "),"icon"==e.show_flag?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.name,placement:"bottom-start"}},[a("el-button",{staticStyle:{"margin-right":"5px"},attrs:{type:e.but_type,icon:e.img,circle:""},on:{click:function(a){return t.onRowBtnClick(i,n,e)}}})],1):t._e(),t._v(" "),"text"!==e.show_flag&&null!==e.img&&"icon"!==e.show_flag?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.name,placement:"bottom-start"}},[a("i",{class:e.img,style:[{marginRight:"5px",color:e.color,fontSize:"15px"}],attrs:{size:"mini",circle:""},on:{click:function(a){return t.onRowBtnClick(i,n,e)}}})]):t._e()],1)}))}}])})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.title+"人员基础信息",visible:t.new_addShow,width:"550px"},on:{"update:visible":function(e){t.new_addShow=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{model:t.new_addInfo,rules:t.rules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"self_id",hidden:""}},[a("el-input",{staticClass:"filter-item",model:{value:t.new_addInfo.self_id,callback:function(e){t.$set(t.new_addInfo,"self_id",e)},expression:"new_addInfo.self_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"真实姓名",prop:"actual_name"}},[a("el-input",{staticClass:"filter-item",model:{value:t.new_addInfo.actual_name,callback:function(e){t.$set(t.new_addInfo,"actual_name",e)},expression:"new_addInfo.actual_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"英文名称",prop:"english_name"}},[a("el-input",{staticClass:"filter-item",model:{value:t.new_addInfo.english_name,callback:function(e){t.$set(t.new_addInfo,"english_name",e)},expression:"new_addInfo.english_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证号",prop:"identity_card"}},[a("el-input",{staticClass:"filter-item",model:{value:t.new_addInfo.identity_card,callback:function(e){t.$set(t.new_addInfo,"identity_card",e)},expression:"new_addInfo.identity_card"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},attrs:{placeholder:"请选择",clearable:""},model:{value:t.new_addInfo.sex,callback:function(e){t.$set(t.new_addInfo,"sex",e)},expression:"new_addInfo.sex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),t._v(" "),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.new_addShow=!1}}},[t._v("\n        取消\n      ")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.addNewPersonal}},[t._v("\n        提交\n      ")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"导入Excel文件",visible:t.basicpersonExcel,width:"550px"},on:{"update:visible":function(e){t.basicpersonExcel=e}}},[a("div",{domProps:{innerHTML:t._s(t.aHtml)}}),t._v(" "),a("div",{staticStyle:{width:"100%",height:"20px"}}),t._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.uploadUrl(),accept:".xls,.xlsx","on-preview":t.handlePreview,"on-remove":t.handleRemove,"show-file-list":!0,limit:1,name:"importFile",headers:t.uploadHeaders(),"on-success":t.onSuccess}},[a("el-button",{attrs:{slot:"trigger",round:"",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitUpload}},[t._v("确 定")])],1)],1)],1)},n=[],s=a("b775");function l(t){return Object(s["a"])({url:"/school/basic_personal/basicPersonList",method:"get",params:t})}function o(t){return Object(s["a"])({url:"/school/basic_personal/basicPersonPage",method:"get",params:t})}function r(t){return Object(s["a"])({url:"/school/basic_personal/createBasicPerson",method:"get",params:{self_id:t}})}function c(t){return Object(s["a"])({url:"/school/basic_personal/addBasicPerson",method:"get",params:t})}function d(t){return Object(s["a"])({url:"/school/basic_personal/basicPersonImport",method:"get",params:t})}var u=a("5f87"),f=a("c9d9"),_={components:{},props:{},data:function(){return{thButtonInfo:[],thPageInfo:[],tableKey:0,list:[],listQuery:{actual_name:"",identity_card:""},groupOption:[],title:"新增",new_addShow:!1,new_addInfo:{self_id:"",actual_name:"",identity_card:"",english_name:"",sex:""},rules:{actual_name:[{required:!0,message:"请输入姓名",trigger:"blur"}],identity_card:[{required:!0,message:"请输入身份证号码",trigger:"blur"}]},basicpersonExcel:!1,aHtml:"",import_color:"",import_text:"",import_url:"",file_id:"",returnUrl:""}},created:function(){var t=this;this.getList(),l().then((function(e){t.thButtonInfo=e.data.button_info,t.thPageInfo=e.data.page_info,t.import_color=e.data.import_info.import_color,t.import_text=e.data.import_info.import_text,t.import_url=e.data.import_info.import_url}))},methods:{getList:function(){var t=this;this.listLoading=!0,o(this.listQuery).then((function(e){t.list=e.data.items,t.total=e.data.total,t.listLoading=!1}))},onThBtnClick:function(t){if("edit"==t.use_type)this.new_addShow=!0;else if("imports"==t.flag){this.basicpersonExcel=!0;var e=this;e.aHtml='<a style="color:'+this.import_color+'" href="'+this.import_url+'">'+this.import_text+"</a>"}},onFilter:function(){this.listQuery.page=1,this.getList()},onRowBtnClick:function(t,e,a){var i=this;a.use_type==f["a"].ajax?"use_flag"==a.flag?contactsUseFlag(t.self_id).then((function(e){t.use_flag=e.data.use_flag})):"delete_flag"==a.flag&&this.$confirm("此操作将删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.self_id?contactsDelFlag(t.self_id).then((function(t){i.$notify({title:"成功",message:t.msg,type:"success",duration:2e3}),i.list.splice(e,1)})):i.list.splice(e,1)})).catch((function(){i.$message({type:"info",message:"已取消"})})):"edit"==a.use_type&&(this.new_addShow=!0,this.title="修改",console.log(t.self_id),this.createBasicPerson(t.self_id))},createBasicPerson:function(t){var e=this;r(t).then((function(t){e.new_addInfo.self_id=t.data.info.self_id,e.new_addInfo.actual_name=t.data.info.actual_name,e.new_addInfo.identity_card=t.data.info.identity_card,e.new_addInfo.english_name=t.data.info.english_name,e.new_addInfo.sex=t.data.info.sex}))},addNewPersonal:function(){var t=this;c(this.new_addInfo).then((function(e){t.$message({message:e.msg,type:"success",center:!0}),setTimeout((function(){t.getList(),t.new_addShow=!1}),500)}))},handlePreview:function(t){},handleRemove:function(t,e){},uploadUrl:function(){var t="".concat(window.location.origin).concat("/prod-api","/up/execl");return t},uploadHeaders:function(){return{dtoken:Object(u["a"])()}},onSuccess:function(t,e,a){this.file_id=t.data.self_id,this.returnUrl=t.data.pathurl},submitUpload:function(){var t=this,e={importurl:this.returnUrl,file_id:this.file_id};d(e).then((function(e){t.$message({message:e.msg,type:"success",center:!0}),setTimeout((function(){t.getList(),t.basicpersonExcel=!1,t.$refs.upload.clearFiles()}),1e3)})).catch((function(e){t.$message({showClose:!0,dangerouslyUseHTMLString:!0,message:e,type:"error",center:!0,duration:0})}))}}},m=_,p=(a("94d2"),a("2877")),h=Object(p["a"])(m,i,n,!1,null,"fe910c6a",null);e["default"]=h.exports}}]);