(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-84243694"],{"0f28":function(t,e,n){"use strict";function o(){var t="".concat(window.location.origin).concat("/prod-api","/up/img");return t}n.d(e,"a",(function(){return o}))},"1c54":function(t,e,n){},"49f3":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{ref:"postForm",attrs:{model:t.postForm,"label-width":"120px"}},[n("section",[n("div",{staticClass:"flex-space-between table-title-container"},[n("div",[t._v("配置【"+t._s(t.groupInfo.group_name)+"】门店模板（可拖动排序）")]),t._v(" "),n("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onItemAddClick()}}},[t._v("新增")])],1),t._v(" "),n("el-table",{ref:"dragTable",staticClass:"myTable",staticStyle:{width:"100%"},attrs:{"row-key":"self_id",data:t.postForm.config,border:"",fit:""}},[n("el-table-column",{attrs:{label:"功能",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-select",{attrs:{placeholder:"请选择功能"},model:{value:o.type,callback:function(e){t.$set(o,"type",e)},expression:"row.type"}},t._l(t.homeTemplate,(function(t){return n("el-option",{key:t.key,attrs:{value:t.key,label:t.name}})})),1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"是否开启",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-select",{attrs:{placeholder:"请选择是否开启"},model:{value:o.use_flag,callback:function(e){t.$set(o,"use_flag",e)},expression:"row.use_flag"}},[n("el-option",{attrs:{label:"是",value:"Y"}}),t._v(" "),n("el-option",{attrs:{label:"否",value:"N"}})],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"背景",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-select",{attrs:{placeholder:"背景类型"},on:{change:function(e){return t.onGroundFlagChanged(o)}},model:{value:o.ground_flag,callback:function(e){t.$set(o,"ground_flag",e)},expression:"row.ground_flag"}},[n("el-option",{attrs:{label:"无底色",value:"no"}}),t._v(" "),n("el-option",{attrs:{label:"颜色底",value:"color"}}),t._v(" "),n("el-option",{attrs:{label:"图片底",value:"img"}})],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"背景",width:"170"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row,a=e.$index;return["img"==o.ground_flag?n("image-upload",{attrs:{imageKey:""+a,showLimit:!1,limit:1,title:"",list:o.ground_info},on:{update:t.onImagesUpdate}}):t._e(),t._v(" "),"color"==o.ground_flag?n("el-color-picker",{attrs:{size:"mini"},model:{value:o.ground_info,callback:function(e){t.$set(o,"ground_info",e)},expression:"row.ground_info"}}):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"备注"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-input",{attrs:{placeholder:"备注"},model:{value:o.remark,callback:function(e){t.$set(o,"remark",e)},expression:"row.remark"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"开始时间",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-date-picker",{staticStyle:{width:"190px"},attrs:{clearable:"",type:"datetime",placeholder:"开始时间(空为长期有效)","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:o.start_time,callback:function(e){t.$set(o,"start_time",e)},expression:"row.start_time"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"结束时间",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[n("el-date-picker",{staticStyle:{width:"190px"},attrs:{clearable:"",type:"datetime",placeholder:"结束时间(空为长期有效)","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:o.end_time,callback:function(e){t.$set(o,"end_time",e)},expression:"row.end_time"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center",width:"100","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row,a=e.$index;return[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.onItemDeleteClick(o,a)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),n("el-form-item",{staticStyle:{"text-align":"center","margin-left":"0","margin-top":"20px"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),n("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])],1)],1)],1)},a=[],r=(n("ac6a"),n("ade3")),i=n("61f7"),l=n("a2a9"),s=n("8a7c"),u=n("e310"),c=n("0835"),d=n("aa47"),f={self_id:"",config:[{type:"",remark:"",start_time:"",end_time:"",use_flag:"Y",ground_flag:"no",ground_info:""}]},m={name:"ArticleDetail",components:{ImageUpload:c["a"]},data:function(){var t=this,e=function(e,n,o){""===n?(t.$message({message:e.field+"为必传项",type:"error"}),o(new Error(e.field+"为必传项"))):o()},n=function(e,n,o){n?Object(i["validURL"])(n)?o():(t.$message({message:"外链url填写不正确",type:"error"}),o(new Error("外链url填写不正确"))):o()};return{isEdit:!1,postForm:Object.assign({},f),loading:!1,groupOptions:[],goodTypeOptions:[],goodStatusOptions:[],classifyOptions:[],keyInfo:[],homeTemplate:[],groupInfo:{},sortable:null,rules:Object(r["a"])({image_uri:[{validator:e}],title:[{validator:e}],content:[{validator:e}],source_uri:[{validator:n,trigger:"blur"}],type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}]},"title",[{required:!0,message:"title is required",trigger:"blur"}]),tempRoute:{}}},computed:{contentShortLength:function(){return this.postForm.content_short.length},displayTime:{get:function(){return+new Date(this.postForm.display_time)},set:function(t){this.postForm.display_time=new Date(t)}}},created:function(){var t=this,e=this.$route.query&&this.$route.query.id;this.isEdit=void 0!=e,this.postForm.self_id=e,this.fetchData(e),Object(l["f"])(e).then((function(e){t.goodStatusOptions=e.data.good_status,t.goodTypeOptions=e.data.good_type,e.data.goods_info&&(t.postForm=e.data.goods_info,t.onGroupChanged(t.postForm.group_code)),t.keyInfo=e.data.key_info.map((function(e){return e.images=t.postForm[e.key]?t.postForm[e.key]:[],e}))})),Object(u["b"])().then((function(e){t.groupOptions=e.data.items})),this.tempRoute=Object.assign({},this.$route)},methods:{fetchData:function(t){var e=this;Object(s["f"])(t).then((function(t){e.homeTemplate=t.data.home_template,e.groupInfo=t.data.group_info,e.postForm.config=t.data.config,e.$nextTick((function(){e.setSort()}))}))},setSort:function(){var t=this,e=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=d["default"].create(e,{ghostClass:"sortable-ghost",setData:function(t){t.setData("Text","")},onEnd:function(e){var n=t.postForm.config.splice(e.oldIndex,1)[0];console.log(n,e.oldIndex,e.newIndex),t.postForm.config.splice(e.newIndex,0,n)}})},setTagsViewTitle:function(){var t="Edit Article",e=Object.assign({},this.tempRoute,{title:"".concat(t,"-").concat(this.postForm.id)});this.$store.dispatch("tagsView/updateVisitedView",e)},onGroundFlagChanged:function(t){t.ground_info=""},onGroupChanged:function(t){var e=this;Object(l["fetchClassify"])(t).then((function(t){e.classifyOptions=t.data.classify_info}))},onImagesUpdate:function(t){this.postForm.config[t.imageKey].ground_info=t.images,console.log(t)},onItemAddClick:function(){this.postForm.config.push({type:"",remark:"",start_time:"",end_time:"",use_flag:"Y",ground_flag:"no",ground_info:""})},onItemDeleteClick:function(t,e){var n=this;this.$confirm("此操作将删除该条配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.self_id?Object(s["c"])(t.self_id).then((function(t){n.$notify({title:"成功",message:t.msg,type:"success",duration:2e3}),n.postForm.config.splice(e,1)})):n.postForm.config.splice(e,1)}))},onSubmit:function(){var t=this;this.$refs.postForm.validate((function(e){if(!e)return!1;t.loading=!0,Object(s["a"])(t.postForm).then((function(e){t.$notify({title:"成功",message:"模板编辑成功！",type:"success",duration:2e3}),setTimeout((function(){t.$router.go(-1)}),1e3)})),t.loading=!1}))}}},p=m,g=(n("6e9a"),n("2877")),h=Object(g["a"])(p,o,a,!1,null,"fc9f814c",null);e["default"]=h.exports},"6e9a":function(t,e,n){"use strict";n("1c54")},"8a7c":function(t,e,n){"use strict";n.d(e,"h",(function(){return a})),n.d(e,"i",(function(){return r})),n.d(e,"f",(function(){return i})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return f}));var o=n("b775");function a(t){return Object(o["a"])({url:"/pages/template/templateList",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/pages/template/templatePage",method:"get",params:t})}function i(t){return Object(o["a"])({url:"/pages/template/createHomeConfig",method:"get",params:{self_id:t}})}function l(t){return Object(o["a"])({url:"/pages/template/addHomeConfig",method:"post",data:t})}function s(t){return Object(o["a"])({url:"/pages/template/configDelFlag",method:"post",data:{self_id:t}})}function u(t){return Object(o["a"])({url:"/pages/template/createHomeConfigData",method:"post",data:{self_id:t}})}function c(t){return Object(o["a"])({url:"/pages/template/configDataDelFlag",method:"post",data:{self_id:t}})}function d(t){return Object(o["a"])({url:"/pages/template/addHomeConfigData",method:"post",data:t})}function f(t){return Object(o["a"])({url:"/pages/template/getData",method:"post",data:t})}},a2a9:function(t,e,n){"use strict";n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return l})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return u}));var o=n("b775");function a(t){return Object(o["a"])({url:"/goods/goods/goodsList",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/goods/goods/goodsPage",method:"get",params:t})}function i(t){return Object(o["a"])({url:"/goods/goods/goodsDeleteFlag",method:"post",data:{self_id:t}})}function l(t){return Object(o["a"])({url:"/goods/goods/goodsStatusFlag",method:"post",data:{self_id:t}})}function s(t){return Object(o["a"])({url:"/goods/goods/createGoods",method:"get",params:{self_id:t}})}function u(t){return Object(o["a"])({url:"/goods/goods/addGoods",method:"post",data:t})}},e310:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"m",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return c})),n.d(e,"g",(function(){return d})),n.d(e,"i",(function(){return f})),n.d(e,"j",(function(){return m})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return g})),n.d(e,"n",(function(){return h}));var o=n("b775");function a(t){return Object(o["a"])({url:"/school/line/lineList",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/school/line/linePage",method:"get",params:t})}function i(t){return Object(o["a"])({url:"company/company/getGroup",method:"get",params:t})}function l(t){return Object(o["a"])({url:"/school/line/lineAdd",method:"get",params:t})}function s(t){return Object(o["a"])({url:"/school/line/createLine",method:"get",params:t})}function u(t){return Object(o["a"])({url:"/school/line/linePathway",method:"get",params:t})}function c(t){return Object(o["a"])({url:"/school/line/linePathwayDelete",method:"get",params:t})}function d(t){return Object(o["a"])({url:"/school/line/linePathwayAdd",method:"get",params:t})}function f(t){return Object(o["a"])({url:"/school/line/pathwayStation",methods:"get",params:t})}function m(t){return Object(o["a"])({url:"/school/line/pathwayStudent",method:"get",params:t})}function p(t){return Object(o["a"])({url:"/school/line/pathwayStudentAdd",method:"get",params:t})}function g(t){return Object(o["a"])({url:"/school/line/studentImport",method:"get",params:t})}function h(t){return Object(o["a"])({url:"/school/line/lineExcel",methods:"get",params:t})}}}]);