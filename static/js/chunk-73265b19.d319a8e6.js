(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73265b19"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),Math.easeInOutQuad=function(t,e,a,o){return t/=o/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function i(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(t,e,a){var r=i(),s=t-r,l=20,u=0;e="undefined"===typeof e?500:e;var c=function t(){u+=l;var i=Math.easeInOutQuad(u,r,s,e);n(i),u<e?o(t):a&&"function"===typeof a&&a()};c()}},"0f28":function(t,e,a){"use strict";function o(){var t="".concat(window.location.origin).concat("/prod-api","/up/img");return t}a.d(e,"a",(function(){return o}))},"2fdb":function(t,e,a){"use strict";var o=a("5ca1"),n=a("d2c8"),i="includes";o(o.P+o.F*a("5147")(i),"String",{includes:function(t){return!!~n(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5147:function(t,e,a){var o=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[o]=!1,!"/./"[t](e)}catch(n){}}return!0}},"777d":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"postForm",attrs:{model:t.postForm,"label-width":"120px"}},[a("section",[a("div",{staticClass:"flex-space-between table-title-container"},[a("div",[t._v("您配置的是 "+t._s(t.configTitle.group_name)+"的"+t._s(t.configTitle.template)+"数据（可拖动排序）")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.onItemAddClick()}}},[t._v("新增数据")])],1),t._v(" "),a("el-table",{ref:"dragTable",staticClass:"myTable",staticStyle:{width:"100%"},attrs:{"row-key":"self_id",data:t.postForm.configData,fit:""}},[a("el-table-column",{attrs:{label:"图片",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row,n=e.$index;return[a("image-upload",{attrs:{imageKey:""+n,showLimit:!1,limit:1,title:"",list:o.url},on:{update:t.onImagesUpdate}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"名称",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[a("el-input",{attrs:{placeholder:"名称"},model:{value:o.name,callback:function(e){t.$set(o,"name",e)},expression:"row.name"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类型",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[a("el-select",{attrs:{placeholder:"请选择功能"},on:{change:function(e){return t.onJumpTypeChanged(o,o.jump_type)}},model:{value:o.jump_type,callback:function(e){t.$set(o,"jump_type",e)},expression:"row.jump_type"}},t._l(t.jumpType,(function(t){return a("el-option",{key:t.key,attrs:{value:t.key,label:t.name}})})),1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类型值"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row;return[["good","shop","classify"].includes(o.jump_type)?a("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.onJumpDataClick(o)}}},[t._v(t._s(o.data_name?o.data_name:"请选择"))]):"web"==o.jump_type?a("el-input",{attrs:{placeholder:"例如：http(s)://www.baidu.com"},model:{value:o.remark,callback:function(e){t.$set(o,"remark",e)},expression:"row.remark"}}):"N"==o.jump_type?a("el-input",{attrs:{disabled:"",value:"不跳转"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.row,n=e.$index;return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.onItemDeleteClick(o,n)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"center","margin-left":"0","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogTitle(t.operateRow.jump_type)+"列表",visible:t.dialogTableVisible,width:"80%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{attrs:{data:t.dialogList},on:{"row-click":t.onJumpDataRowClick}},[a("div",[a("el-table-column",{attrs:{property:"name",label:"商品","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{property:"group_name",label:"公司",width:"250"}})],1)]),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.dialogTotal>0,expression:"dialogTotal > 0"}],attrs:{total:t.dialogTotal,"page-sizes":t.dialogThPageInfo,page:t.dialogListQuery.page,limit:t.dialogListQuery.num},on:{"update:page":function(e){return t.$set(t.dialogListQuery,"page",e)},"update:limit":function(e){return t.$set(t.dialogListQuery,"num",e)},pagination:t.getGoods}})],1)],1)},n=[],i=(a("7f7f"),a("6762"),a("2fdb"),a("ade3")),r=a("61f7"),s=a("8a7c"),l=a("a2a9"),u=a("aa47"),c=a("0835"),d=a("333d"),p={self_id:"",configData:[{data_value:"",jump_type:"",name:"",url:[]}]},f={name:"ArticleDetail",components:{ImageUpload:c["a"],Pagination:d["a"]},data:function(){var t=this,e=function(e,a,o){""===a?(t.$message({message:e.field+"为必传项",type:"error"}),o(new Error(e.field+"为必传项"))):o()},a=function(e,a,o){a?Object(r["validURL"])(a)?o():(t.$message({message:"外链url填写不正确",type:"error"}),o(new Error("外链url填写不正确"))):o()};return{isEdit:!1,postForm:Object.assign({},p),loading:!1,jumpType:[],configTitle:{},configData:[],sortable:null,operateRow:{},dialogTableVisible:!1,dialogList:[],dialogTotal:0,dialogThPageInfo:[],dialogListLoading:!0,dialogListQuery:{page:1,limit:20,skip_type:""},rules:Object(i["a"])({image_uri:[{validator:e}],title:[{validator:e}],content:[{validator:e}],source_uri:[{validator:a,trigger:"blur"}],type:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}]},"title",[{required:!0,message:"title is required",trigger:"blur"}]),tempRoute:{}}},created:function(){var t=this,e=this.$route.query&&this.$route.query.id;this.isEdit=void 0!=e,this.postForm.self_id=e,this.fetchData(e),Object(l["g"])().then((function(e){t.dialogThPageInfo=e.data.page_info})),this.tempRoute=Object.assign({},this.$route)},methods:{fetchData:function(t){var e=this;Object(s["e"])(t).then((function(t){e.jumpType=t.data.jump_type,e.configTitle=t.data.config_title,e.postForm.configData=t.data.configData,e.$nextTick((function(){e.setSort()}))}))},setSort:function(){var t=this,e=this.$refs.dragTable.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=u["default"].create(e,{ghostClass:"sortable-ghost",setData:function(t){t.setData("Text","")},onEnd:function(e){var a=t.postForm.configData.splice(e.oldIndex,1)[0];t.postForm.configData.splice(e.newIndex,0,a)}})},onItemAddClick:function(){this.postForm.configData.push({data_value:"",jump_type:"",name:"",url:[]})},onImagesUpdate:function(t){this.postForm.configData[t.imageKey].url=t.images},onJumpTypeChanged:function(t,e){["good","shop","classify"].includes(e)&&(this.dialogTableVisible=!0,this.getGoods(e),this.operateRow=t)},dialogTitle:function(t){return{good:"商品",shop:"门店",classify:"分类"}[t]},onJumpDataClick:function(t){this.dialogTableVisible=!0,this.getGoods(t.jump_type),this.operateRow=t},onJumpDataRowClick:function(t){this.operateRow.data_value=t.self_id,this.operateRow.data_name=t.name,this.dialogTableVisible=!1,this.postForm.configData=JSON.parse(JSON.stringify(this.postForm.configData))},getGoods:function(t){var e=this;this.dialogListLoading=!0,this.dialogListQuery.skip_type=t,Object(s["g"])(this.dialogListQuery).then((function(t){e.dialogList=t.data.items,e.dialogTotal=t.data.total,e.dialogListLoading=!1}))},onItemDeleteClick:function(t,e){var a=this;this.$confirm("此操作将删除该条配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.self_id?Object(s["d"])(t.self_id).then((function(t){a.$notify({title:"成功",message:t.msg,type:"success",duration:2e3}),a.postForm.configData.splice(e,1)})):a.postForm.configData.splice(e,1)}))},onSubmit:function(){var t=this;this.$refs.postForm.validate((function(e){if(!e)return!1;t.loading=!0,Object(s["b"])(t.postForm).then((function(e){t.$notify({title:"成功",message:"数据保存成功！",type:"success",duration:2e3}),setTimeout((function(){t.$router.go(-1)}),1e3)})),t.loading=!1}))}}},m=f,g=a("2877"),b=Object(g["a"])(m,o,n,!1,null,"2bcfb4f0",null);e["default"]=b.exports},"8a7c":function(t,e,a){"use strict";a.d(e,"h",(function(){return n})),a.d(e,"i",(function(){return i})),a.d(e,"f",(function(){return r})),a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return u})),a.d(e,"d",(function(){return c})),a.d(e,"b",(function(){return d})),a.d(e,"g",(function(){return p}));var o=a("b775");function n(t){return Object(o["a"])({url:"/pages/template/templateList",method:"get",params:t})}function i(t){return Object(o["a"])({url:"/pages/template/templatePage",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/pages/template/createHomeConfig",method:"get",params:{self_id:t}})}function s(t){return Object(o["a"])({url:"/pages/template/addHomeConfig",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/pages/template/configDelFlag",method:"post",data:{self_id:t}})}function u(t){return Object(o["a"])({url:"/pages/template/createHomeConfigData",method:"post",data:{self_id:t}})}function c(t){return Object(o["a"])({url:"/pages/template/configDataDelFlag",method:"post",data:{self_id:t}})}function d(t){return Object(o["a"])({url:"/pages/template/addHomeConfigData",method:"post",data:t})}function p(t){return Object(o["a"])({url:"/pages/template/getData",method:"post",data:t})}},a2a9:function(t,e,a){"use strict";a.d(e,"g",(function(){return n})),a.d(e,"h",(function(){return i})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"a",(function(){return u}));var o=a("b775");function n(t){return Object(o["a"])({url:"/goods/goods/goodsList",method:"get",params:t})}function i(t){return Object(o["a"])({url:"/goods/goods/goodsPage",method:"get",params:t})}function r(t){return Object(o["a"])({url:"/goods/goods/goodsDeleteFlag",method:"post",data:{self_id:t}})}function s(t){return Object(o["a"])({url:"/goods/goods/goodsStatusFlag",method:"post",data:{self_id:t}})}function l(t){return Object(o["a"])({url:"/goods/goods/createGoods",method:"get",params:{self_id:t}})}function u(t){return Object(o["a"])({url:"/goods/goods/addGoods",method:"post",data:t})}},d2c8:function(t,e,a){var o=a("aae3"),n=a("be13");t.exports=function(t,e,a){if(o(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(n(t))}}}]);