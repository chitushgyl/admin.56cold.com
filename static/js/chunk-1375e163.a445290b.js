(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1375e163"],{"23ba":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var i=a("b775");function o(t){return Object(i["a"])({url:"company/company/getGroup",method:"get",params:t})}},"7f87":function(t,e,a){},b31c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"dashboard-container",staticStyle:{width:"100%",height:"calc(100vh - 50px)",position:"relative"}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around",gutter:10}},[a("el-col",{staticStyle:{"padding-top":"15px","min-width":"255px",display:"none"},attrs:{span:4}},[a("div",{staticClass:"left-content"},[a("v-chart",{ref:"pie1",staticClass:"my-chart",staticStyle:{width:"80%",height:"80%"},attrs:{options:t.pie1}}),t._v(" "),a("v-chart",{ref:"pie2",staticClass:"my-chart",staticStyle:{width:"80%",height:"80%"},attrs:{options:t.pie2}}),t._v(" "),a("v-chart",{ref:"pie3",staticClass:"my-chart",staticStyle:{width:"80%",height:"80%"},attrs:{options:t.pie3}})],1)]),t._v(" "),a("el-col",{staticStyle:{padding:"0"},attrs:{span:24}},[a("el-col",{staticStyle:{padding:"10px 0"},attrs:{span:24}},[a("el-col",{attrs:{span:6}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择公司"},model:{value:t.chooseGroup,callback:function(e){t.chooseGroup=e},expression:"chooseGroup"}},t._l(t.groupArr,(function(t,e){return a("el-option",{key:e,attrs:{value:t.group_code,label:t.group_name}})})),1)],1),t._v(" "),a("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:6}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择校车状态"},model:{value:t.chooseStatue,callback:function(e){t.chooseStatue=e},expression:"chooseStatue"}},t._l(t.statue,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),a("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:6}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","picker-options":t.pickerOptions,format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dayTime,callback:function(e){t.dayTime=e},expression:"dayTime"}})],1)]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px",background:"#e78a20",border:"none"},attrs:{type:"success",round:""},on:{click:t.sure}},[t._v("确定")])],1),t._v(" "),a("el-col",{staticStyle:{position:"relative"},attrs:{span:24}},[a("el-amap",{staticClass:"amap-box",attrs:{id:"containMap",vid:"amap-vue",center:t.center,zoom:t.zoom,"amap-manager":t.amapManager,events:t.events}}),t._v(" "),a("div",{staticClass:"mid-content"},[a("el-carousel",{staticStyle:{height:"100px",background:"#f5f5f5","box-shadow":"3px 3px 5px #bbb7b7","border-radius":"8px"},attrs:{interval:1e4,direction:"vertical",autoplay:!0},on:{change:t.carouselChange}},t._l(t.pathInfo,(function(e,i){return a("el-carousel-item",{key:i},[a("div",{},[a("div",{staticClass:"mid-content-left",staticStyle:{width:"100px",position:"relative",float:"left"}},[a("div",{staticStyle:{width:"50px",height:"50px",margin:"25px auto"}},[a("img",{staticStyle:{width:"100%"},attrs:{src:e.img,alt:""}})])]),t._v(" "),a("div",{staticStyle:{"margin-left":"100px","min-width":"500px"}},[a("div",{staticStyle:{height:"40px",display:"flex","padding-left":"10px"}},[a("div",{staticClass:"text-cut",staticStyle:{height:"40px","line-height":"40px",width:"150px","font-weight":"600"}},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"text-cut",staticStyle:{height:"40px","line-height":"40px",width:"150px"}},[t._v(t._s("车牌："+e.default_car_brand))]),t._v(" "),a("div",{staticClass:"text-cut",staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s("照管员："+e.default_care_name+" "+e.default_care_tel))])]),t._v(" "),a("div",{staticStyle:{height:"50px","padding-left":"10px"}},[a("div",{staticClass:"two-cut",staticStyle:{"white-space":"wrap",height:"50px","line-height":"25px","font-size":"13px"}},[t._v("\n                                            "+t._s("站点："+e.path_show)+"\n                                            ")])])])])])})),1)],1)],1)],1)],1)],1)])},o=[],n=(a("7f7f"),a("6b54"),a("f576"),a("23ba")),r=a("b775");function s(t){return Object(r["a"])({url:"/school/history/historyInfo",method:"get",params:t})}function l(t){return Object(r["a"])({url:"/school/history/getAddress",method:"get",params:t})}var c=a("9ca8"),p=(a("c037"),a("d28f"),a("627c"),a("007d"),a("8f9b")),h=new p["AMapManager"],d={components:{"v-chart":c["a"]},data:function(){var t=this;return{chooseGroup:"",amapManager:h,chart1:null,chart2:null,chart3:null,center:[121.329402,31.228667],zoom:20,events:{init:function(){p["lazyAMapApiLoaderInstance"].load().then((function(){t.initSearch()}))}},statue:[{value:"UP",label:"上学"},{value:"down",label:"放学"}],chooseStatue:"UP",dayTime:this.getNowTime(),pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()}},groupArr:[],myChart:{},pie1:{color:["#e78a20","#ebcca9"],title:{text:"车辆运行信息",left:"5%",textStyle:{color:"#FFFFFF"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",right:"3%",top:"35%",data:[],textStyle:{color:"#FFFFFF"},temWidth:20,itemHeight:20},series:[{name:"车辆运行信息",type:"pie",radius:"45%",center:["25%","47%"],data:[],label:{show:!1,position:"center"}}]},pie2:{color:["#e78a20","#ebcca9"],title:{text:"学生信息",textStyle:{color:"#FFFFFF"},left:"5%",top:"15px"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",top:"40%",right:"3%",data:[],textStyle:{color:"#FFFFFF"},temWidth:21,itemHeight:21},series:[{name:"学生信息",type:"pie",radius:"45%",center:["25%","52%"],data:[],label:{show:!1,position:"center"}}]},pie3:{color:["#e78a20","#ebcca9"],title:{text:"工作人员信息",textStyle:{color:"#FFFFFF"},left:"5%"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",top:"35%",right:"3%",data:[],textStyle:{color:"#FFFFFF"},temWidth:20,itemHeight:20},series:[{name:"工作人员信息",type:"pie",radius:"45%",center:["25%","47%"],data:[],label:{show:!1,position:"center"}}]},pathInfo:[],pathWay:[],originPath:[],markers:[],position:[],groupMarker:[],logo:""}},created:function(){var t=this;Object(n["a"])().then((function(e){e.data.items.length>0&&(t.groupArr=e.data.items,t.chooseGroup=t.groupArr[0].group_code,t.sure())})),this.$nextTick((function(){t.$refs.pie1.resize(),t.$refs.pie2.resize(),t.$refs.pie3.resize()}))},mounted:function(){},beforeDestroy:function(){},methods:{getNowTime:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth(),i=t.getDate();a+=1,a=a.toString().padStart(2,"0"),i=i.toString().padStart(2,"0");var o="".concat(e,"-").concat(a,"-").concat(i);return o},initSearch:function(){var t=this,e=this.amapManager.getMap(),a=["#cccccc","#cccccc"];t.pathWay.length>0&&(window.pathSimplifierIns&&pathSimplifierIns.setData([]),AMapUI.loadUI(["misc/PathSimplifier"],(function(i){if(i.supportCanvas){var o=new i({zIndex:100,map:e,getPath:function(t,e){return t.path},getHoverTitle:function(t,e,a){return a>=0?t.name+"，点："+a+"/"+t.path.length:t.name+"，点数量"+t.path.length},renderOptions:{pathLineStyle:{dirArrowStyle:!0},getPathStyle:function(t,e){var o=a[t.pathIndex%a.length],n=Math.round(2*Math.pow(1.1,e-3));return{pathLineStyle:{strokeStyle:0==t.pathIndex?a[0]:a[1],lineWidth:n},pathLineSelectedStyle:{lineWidth:n+2},pathNavigatorStyle:{fillStyle:o,content:i.Render.Canvas.getImageContent("https://webapi.amap.com/images/car.png",(function(t){}),(function(t){console.log(t)})),initRotateDegree:-90,pathLinePassedStyle:null,width:30,height:20}}}}});window.pathSimplifierIns=o,o.setData(t.pathWay);for(var n=0;n<t.pathWay.length;n++){t.get_ThisPath(t.pathInfo,t.pathWay[0].self_id);var r=o.createPathNavigator(n,{loop:!0,speed:200});r.start()}o.setSelectedPathIndex(0),o.on("pathClick,pointClick",(function(e,a){var i=a.pathIndex,o=t.pathWay[i].self_id;t.removeMarkers(t.markers),t.get_ThisPath(t.pathInfo,o)}))}else alert("当前环境不支持 Canvas！")})))},carouselChange:function(t){var e="";if(this.originPath&&this.originPath.length>0){e=this.originPath[t].self_id;for(var a=0;a<this.pathWay.length;a++)window.pathSimplifierIns&&e==this.pathWay[a].self_id&&(pathSimplifierIns.setSelectedPathIndex(a),this.removeMarkers(this.markers),this.get_ThisPath(this.pathInfo,e))}},sure:function(){var t=this,e={group_code:this.chooseGroup,site_type:this.chooseStatue,time:this.dayTime};s(e).then((function(e){if(t.pathInfo=e.data.pathInfo,t.logo=e.data.school_address.logo,!t.pathInfo.length){var a=t.amapManager.getMap();pathSimplifierIns.setData([]),a.remove(t.groupMarker)}console.log(123),t.get_history()})).catch((function(t){console.log("无数据"),console.log(t)}))},get_history:function(){var t=this,e={group_code:this.chooseGroup,site_type:this.chooseStatue,time:this.dayTime};l(e).then((function(e){var a=t.amapManager.getMap();if(e.data.longitude&&e.data.dimensionality&&(a.remove(t.groupMarker),t.position=[e.data.longitude,e.data.dimensionality],t.position.length>1)){var i=new AMap.Icon({image:t.logo,imageSize:new AMap.Size(46,46),size:new AMap.Size(46,46)}),o=new AMap.Marker({icon:i,position:t.position,zIndex:101,map:a});t.groupMarker.push(o),a.setCenter(t.position)}if(e.data.hasOwnProperty("guiji")){if(e.data.guiji.length>0&&(t.originPath=e.data.guiji,t.pathWay=[],t.originPath&&t.originPath.length>0)){for(var n=0;n<t.originPath.length;n++)t.originPath[n].path&&t.originPath[n].path.length>0&&t.pathWay.push(t.originPath[n]);t.initSearch()}}else pathSimplifierIns.setData([]),a.remove(t.markers)}))},get_ThisPath:function(t,e){var a=[];if(console.log(t),t.length>0)for(var i=0;i<t.length;i++)t[i].self_id==e&&(a=t[i],this.createMarker(a))},createMarker:function(t){var e=t.path,a=this.amapManager.getMap();if(e&&e.length>0)for(var i=0;i<e.length;i++){var o=new AMap.Marker({map:a,icon:new AMap.Icon({image:"//a.amap.com/jsapi_demos/static/demo-center/icons/poi-marker-default.png",size:new AMap.Size(22,28),imageSize:new AMap.Size(22,28)}),position:e[i].lnglat,offset:new AMap.Pixel(-13,-30),label:{content:"<div class='info'>"+t.name+e[i].name+"</div>",direction:"top"}});this.markers.push(o)}},removeMarkers:function(){var t=this.amapManager.getMap();t.remove(this.markers)}}},g=d,u=(a("cdcf"),a("2877")),f=Object(u["a"])(g,i,o,!1,null,"1c19d86a",null);e["default"]=f.exports},cdcf:function(t,e,a){"use strict";a("7f87")}}]);